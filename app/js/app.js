(function(t){function e(e){for(var i,s,r=e[0],c=e[1],l=e[2],p=0,d=[];p<r.length;p++)s=r[p],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&d.push(n[s][0]),n[s]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);u&&u(e);while(d.length)d.shift()();return o.push.apply(o,l||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],i=!0,r=1;r<a.length;r++){var c=a[r];0!==n[c]&&(i=!1)}i&&(o.splice(e--,1),t=s(s.s=a[0]))}return t}var i={},n={app:0},o=[];function s(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=i,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(a,i,function(e){return t[e]}.bind(null,i));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=c;o.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"39c2":function(t,e,a){a("ac1f"),a("1276"),CROP_THUMBNAILS_DO_CACHE_BREAK=function(t){for(var e=jQuery,a=e(t),i=0;i<a.length;i++){var n=e(a[i]),o=n.attr("src"),s=o.split("?");n.attr("src",s[0]+"?&cacheBreak="+(new Date).getTime())}}},"55d5":function(t,e,a){(function(t){t.CROP_THUMBNAILS_VUE={app:null,components:{}}}).call(this,a("c8ba"))},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d"),a("7046"),a("83a8"),a("55d5"),a("39c2"),a("bc36");var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.cropData&&t.lang?a("div",{staticClass:"cptEditorInner",class:{loading:t.loading,cropEditorActive:t.croppingApi}},[t.loading?a("div",{staticClass:"cptWaitingWindow"},[a("div",{staticClass:"msg"},[t._v(" "+t._s(t.lang.waiting)+" "),t._m(0)])]):t._e(),t.cropData.hiddenOnPostType?a("div",{staticClass:"cptWaitingWindow cptCropDisabledMsg"},[a("div",{staticClass:"msg"},[t._v(t._s(t.lang.cropDisabled))])]):t._e(),t.cropData.noPermission?a("div",{staticClass:"cptWaitingWindow cptNoPermissionMsg"},[a("div",{staticClass:"msg"},[t._v(t._s(t.lang.noPermission))])]):t._e(),t.cropData.hiddenOnPostType||t.cropData.noPermission?t._e():a("div",{staticClass:"mainWindow"},[a("div",{staticClass:"cptSelectionPane",class:{cptImagesAreSelected:t.activeImageSizes.length>0}},[a("div",{staticClass:"cptSelectionPaneInner"},[t.sourceImageHasOrientation?a("message",[t._v(t._s(t.lang.message_image_orientation))]):t._e(),a("p",[a("label",{staticClass:"cptSameRatioLabel"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.selectSameRatio,expression:"selectSameRatio"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.selectSameRatio)?t._i(t.selectSameRatio,null)>-1:t.selectSameRatio},on:{change:function(e){var a=t.selectSameRatio,i=e.target,n=!!i.checked;if(Array.isArray(a)){var o=null,s=t._i(a,o);i.checked?s<0&&(t.selectSameRatio=a.concat([o])):s>-1&&(t.selectSameRatio=a.slice(0,s).concat(a.slice(s+1)))}else t.selectSameRatio=n}}}),t._v(" "+t._s(t.lang.label_same_ratio)+" ")]),a("button",{staticClass:"button",attrs:{type:"button"},on:{click:function(e){return t.makeAllInactive()}}},[t._v(t._s(t.lang.label_deselect_all))])]),t.filteredImageSizes.length>0?a("ul",{staticClass:"cptImageSizelist"},t._l(t.filteredImageSizes,(function(e){return a("li",{key:e.nameLabel,class:t.imageSizeClass(e),on:{click:function(a){return t.toggleActive(e)}}},[a("section",{staticClass:"cptImageSizeInner"},[a("header",[t._v(t._s(e.nameLabel))]),t.isLowRes(e)?a("div",{staticClass:"lowResWarning",attrs:{title:t.lang.lowResWarning}},[a("span",[t._v("!")])]):t._e(),t.isLowRes(e)||e.url!==t.cropData.sourceImage.full.url?t._e():a("div",{staticClass:"notYetCropped",attrs:{title:t.lang.notYetCropped}},[a("span",{staticClass:"dashicons dashicons-image-crop"})]),a("div",{staticClass:"dimensions"},[t._v(t._s(t.lang.dimensions)+" "+t._s(e.width)+" x "+t._s(e.height)+" "+t._s(t.lang.pixel))]),a("div",{staticClass:"ratio"},[t._v(t._s(t.lang.ratio)+" "+t._s(e.printRatio))]),a("loadingcontainer",{attrs:{image:e.url+"?cacheBreak="+e.cacheBreak}},[a("div",{staticClass:"cptImageBgContainer",style:{"background-image":"url("+e.url+"?cacheBreak="+e.cacheBreak+")"}})])],1)])})),0):a("div",{staticClass:"cptImageSizelist"},[a("div",{staticClass:"noImageSizesAvailable"},[t._v(" "+t._s(t.lang.infoNoImageSizesAvailable)+" ")])])],1)]),a("div",{staticClass:"cptCropPane"},[a("div",{staticClass:"info"},[a("h3",[t._v(t._s(t.lang.rawImage))]),a("div",{staticClass:"dimensions"},[t._v(t._s(t.lang.dimensions)+" "+t._s(t.cropData.sourceImage.full.width)+" x "+t._s(t.cropData.sourceImage.full.height)+" "+t._s(t.lang.pixel))]),a("div",{staticClass:"ratio"},[t._v(t._s(t.lang.ratio)+" "+t._s(t.cropData.sourceImage.full.printRatio))])]),a("button",{staticClass:"button cptGenerate",class:{"button-primary":t.croppingApi},attrs:{type:"button",disabled:!t.croppingApi},on:{click:function(e){return t.cropThumbnails()}}},[t._v(t._s(t.lang.label_crop))]),a("div",{staticClass:"cropContainer"},[a("img",{staticClass:"cptCroppingImage",attrs:{src:t.cropImage.url}})]),a("h4",[t._v(t._s(t.lang.instructions_header))]),a("ul",{staticClass:"step-info"},[a("li",[t._v(t._s(t.lang.instructions_step_1))]),a("li",[t._v(t._s(t.lang.instructions_step_2))]),a("li",[t._v(t._s(t.lang.instructions_step_3))])]),a("div",[t.cropData.options.debug_js?a("button",{staticClass:"button",attrs:{type:"button"},on:{click:function(e){return t.showDebugClick("js")}}},[t._v("show JS-Debug")]):t._e(),t.cropData.options.debug_data&&null!==t.dataDebug?a("button",{staticClass:"button",attrs:{type:"button"},on:{click:function(e){return t.showDebugClick("data")}}},[t._v("show Data-Debug")]):t._e(),"data"===t.showDebugType?a("pre",[t._v(t._s(t.dataDebug))]):t._e(),"js"===t.showDebugType?a("pre",[a("br"),t._v("cropImage:"+t._s(t.cropImage)),a("br"),t._v("cropData:"+t._s(t.cropData))]):t._e()])])])]):t._e()},n=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"cptLoadingSpinner"})])}],o=(a("4de4"),a("7db0"),a("4160"),a("b0c0"),a("a9e3"),a("159b"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"loadingcontainer",class:t.status},[a("img",{staticStyle:{display:"none"},attrs:{src:t.image}}),t._t("default"),a("transition",{attrs:{name:"fade"}},["loading"===t.status?a("div",{staticClass:"loadingMsg"},[a("div",{staticClass:"cptLoadingSpinner"})]):t._e()])],2)}),s=[],r={props:{image:{required:!0,type:String}},data:function(){return{status:null}},watch:{image:function(){this.setup()}},mounted:function(){this.setup()},methods:{setup:function(){var t=this;t.setStart(),setTimeout((function(){var e=imagesLoaded(t.$el);e.once("done",(function(){"failed"!==t.status&&t.setComplete()})).once("fail",(function(){t.setFailed()}))}),300)},setComplete:function(){this.status="completed"},setStart:function(){this.status="loading"},setFailed:function(){this.status="failed"}}},c=r,l=a("2877"),u=Object(l["a"])(c,o,s,!1,null,null,null),p=u.exports,d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.closed?t._e():a("div",{staticClass:"notice notice-warning is-dismissible cptMessage",attrs:{"aria-role":"alert"}},[a("p",[t._t("default")],2),a("button",{staticClass:"notice-dismiss",attrs:{type:"button","aria-label":"close"},on:{click:function(e){return t.close()}}})])},g=[],m={props:{},data:function(){return{closed:!1}},methods:{close:function(){this.closed=!0}}},h=m,_=Object(l["a"])(h,d,g,!1,null,null,null),f=_.exports,v={props:{imageId:{required:!0,type:Number},posttype:{required:!1,type:String,default:null}},components:{loadingcontainer:p,message:f},data:function(){return{cropData:null,loading:!1,selectSameRatio:!0,croppingApi:null,currentCropSize:null,lang:null,nonce:null,showDebugType:null,dataDebug:null}},mounted:function(){this.loadCropData()},computed:{cropImage:function(){if(void 0!==this.cropData){var t=this.cropData.sourceImage.full,e=Math.round(10*t.ratio);return null!==this.cropData.sourceImage.large&&this.cropData.sourceImage.large.width>745&&e===Math.round(10*this.cropData.sourceImage.large.ratio)&&this.cropData.sourceImage.full.url!==this.cropData.sourceImage.large.url&&(t=this.cropData.sourceImage.large),null!==this.cropData.sourceImage.medium_large&&this.cropData.sourceImage.medium_large.width>745&&e===Math.round(10*this.cropData.sourceImage.medium_large.ratio)&&this.cropData.sourceImage.full.url!==this.cropData.sourceImage.medium_large.url&&(t=this.cropData.sourceImage.medium_large),t}},filteredImageSizes:function(){return this.cropData.imageSizes.filter((function(t){return!t.hideByPostType}))},activeImageSizes:function(){return this.cropData.imageSizes.filter((function(t){return t.active}))},sourceImageHasOrientation:function(){try{if("string"===typeof this.cropData.sourceImageMeta.orientation&&"1"!==this.cropData.sourceImageMeta.orientation&&"0"!==this.cropData.sourceImageMeta.orientation)return!0}catch(t){}return!1}},methods:{imageSizeClass:function(t){var e={active:t.active};return e["cptImageSize-"+t.nameLabel]=!0,e},loadCropData:function(){var t=this,e={action:"cpt_cropdata",imageId:this.imageId,posttype:this.posttype};t.loading=!0,jQuery.get(ajaxurl,e,(function(e){t.makeAllInactive(e.imageSizes),t.addCacheBreak(e.imageSizes),t.cropData=e,t.lang=t.cropData.lang,t.nonce=t.cropData.nonce,delete t.cropData.nonce})).fail((function(e){t.cropData=e.responseJSON,t.lang=t.cropData.lang,t.nonce=t.cropData.nonce,delete t.cropData.nonce,403===e.status&&(t.cropData.noPermission=!0)})).always((function(){t.loading=!1}))},isLowRes:function(t){return!(!t.active||null===this.currentCropSize)&&(0===t.width&&this.currentCropSize.height<t.height||(0===t.height&&this.currentCropSize.width<t.width||(9999===t.height?this.currentCropSize.width<t.width:9999===t.width?this.currentCropSize.height<t.height:this.currentCropSize.width<t.width||this.currentCropSize.height<t.height)))},toggleActive:function(t){var e=!t.active;!1===t.active&&this.makeAllInactive(),this.selectSameRatio?this.cropData.imageSizes.forEach((function(a){a.printRatio===t.printRatio&&!1===a.hideByPostType&&(a.active=e)})):t.active=e,this.activeImageSizes.length>0?this.activateCropArea():this.deactivateCropArea()},makeAllInactive:function(t){void 0===t&&(t=this.cropData.imageSizes),t.forEach((function(t){t.active=!1,t.lowResWarning=!1})),this.deactivateCropArea()},addCacheBreak:function(t){void 0===t&&(t=this.cropData.imageSizes),t.forEach((function(t){t.cacheBreak=Date.now()}))},updateCurrentCrop:function(){var t=null;if(null!==this.croppingApi){var e=this.croppingApi.tellSelect();t={width:Math.round(e.w),height:Math.round(e.h)}}this.currentCropSize=t},activateCropArea:function(){var t=this;function e(t,e,a){var i=0,n=0,o=t,s=e,r=t/e;r<=a?(n=e/2-t/a/2,s=e-n):(i=t/2-e*a/2,o=t-i);var c=[i,n,o,s];return c}t.deactivateCropArea();var a={trueSize:[t.cropData.sourceImage.full.width,t.cropData.sourceImage.full.height],aspectRatio:0,setSelect:[],onSelect:t.updateCurrentCrop};t.activeImageSizes.forEach((function(t){0===a.aspectRatio&&(a.aspectRatio=t.ratio),a.aspectRatio!==t.ratio&&console.info('Crop Thumbnails: print ratio is different from normal ratio on image size "'+t.name+'".')})),a.setSelect=e(t.cropData.sourceImage.full.width,t.cropData.sourceImage.full.height,a.aspectRatio),t.cropData.options.debug_js&&console.info("Cropping options",a),jQuery(t.$el).find("img.cptCroppingImage").Jcrop(a,(function(){t.croppingApi=this,t.updateCurrentCrop()}))},deactivateCropArea:function(){null!==this.croppingApi&&(this.croppingApi.destroy(),this.croppingApi=null,this.currentCropSize=null)},showDebugClick:function(t){this.showDebugType===t?this.showDebugType=null:this.showDebugType=t},cropThumbnails:function(){var t=this;function e(){var e=[];return t.activeImageSizes.forEach((function(t){if(t.active){var a={name:t.name,width:t.width,height:t.height,ratio:t.ratio,crop:t.crop};e.push(a)}})),e}if(!t.loading&&null!==t.croppingApi){t.loading=!0;var a={action:"cptSaveThumbnail",_ajax_nonce:t.nonce,cookie:encodeURIComponent(document.cookie),crop_thumbnails:JSON.stringify({selection:t.croppingApi.tellSelect(),sourceImageId:t.cropData.sourceImageId,activeImageSizes:e()})},i=jQuery.post(ajaxurl,a,null,"json");i.done((function(e){if(t.cropData.options.debug_data&&(t.dataDebug=e.debug,console.log("Save Function Debug",e.debug)),void 0===e.error)return void 0!==e.success?(void 0!==e.changedImageName&&t.activeImageSizes.forEach((function(t,a){void 0!==e.changedImageName[t.name]&&(t.url=e.changedImageName[t.name])})),void t.addCacheBreak(t.activeImageSizes)):void 0;alert(e.error)})).fail((function(e){alert(t.lang.script_connection_error);var i={status:e.status,statusText:e.statusText,requestUrl:ajaxurl,requestParams:a};console.error("crop-thumbnails connection error",i)})).always((function(){t.loading=!1}))}}}},b=v,C=Object(l["a"])(b,i,n,!1,null,null,null),y=C.exports,D=a("a026");CROP_THUMBNAILS_VUE.modal=function(){var t=jQuery,e=this;function a(){t("#cpt_Modal .cpt_ModalClose, #cpt_Modal").unbind("click"),t("#cpt_Modal").remove(),t("body").removeClass("cpt_ModalIsOpen")}e.close=function(i){CROP_THUMBNAILS_VUE.app.$destroy(),CROP_THUMBNAILS_VUE.app=null,a(),t("body").trigger("cropThumbnailModalClosed"),document.removeEventListener("keydown",e.closeByEscKey,!0)},e.closeByBackground=function(t){t.target==document.getElementById("cpt_Modal")&&e.close(t)},e.closeByEscKey=function(t){t.keyCode&&27!==t.keyCode||(t.stopPropagation(),e.close(t))},e.open=function(a,i,n){var o=a,s="";s+='<div id="cpt_Modal" class="cpt_Modal">',s+='<div class="cpt_ModalDialog" role="dialog" aria-label="'+t("<div>").text(n).html()+'">',s+='<button type="button" class="cpt_ModalClose" aria-label="close">&times;</button>',s+='<div class="cpt_ModalHeader"><div class="cpt_ModalTitle">'+n+"</div></div>",s+='<div class="cpt_ModalContent" id="cpt_crop_editor">',s+='<cropeditor :image-id="'+o+'"',"string"===typeof i&&(s+=' posttype="'+i+'"'),s+="></cropeditor>",s+="</div>",s+="</div>",s+="</div>",t("body").prepend(s).addClass("cpt_ModalIsOpen"),t("#cpt_Modal .cpt_ModalClose").click(e.close),t("#cpt_Modal").on("touchstart mousedown",e.closeByBackground),document.addEventListener("keydown",e.closeByEscKey,!0),CROP_THUMBNAILS_VUE.app=new D["a"]({el:"#cpt_crop_editor",mounted:function(){console.log("cpt_crop_editor mounted")},components:{cropeditor:y}})}};var S=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"cptSettingsPostListDescription"},[t._v(t._s(t.settingsData.lang.choose_image_sizes))]),a("ul",{staticClass:"cptSettingsPostList"},t._l(t.settingsData.post_types,(function(e){return a("li",{key:e.name},[e?a("section",[a("header",[a("h3",[t._v(t._s(e.label))])]),a("ul",{staticClass:"cptImageSizes"},[t._l(t.settingsData.image_sizes,(function(i){return[i.crop?a("li",{key:i.id},[a("label",[a("input",{attrs:{type:"checkbox",name:"crop-post-thumbs[hide_size]["+e.name+"]["+i.id+"]"},domProps:{value:i.id,checked:t.isImageSizeHidden(e.name,i.id)}}),a("span",{staticClass:"name"},[t._v(t._s(i.name))]),i.name!==i.id?a("span",{staticClass:"defaultName"},[t._v("("+t._s(i.id)+")")]):t._e()])]):t._e()]}))],2),a("label",[a("input",{attrs:{id:"cpt_settings_post",type:"checkbox",name:"crop-post-thumbs[hide_post_type]["+e.name+"]",value:"1"},domProps:{checked:t.isButtonHiddenOnPostType(e.name)}}),t._v(" "+t._s(t.settingsData.lang.hide_on_post_type)+" ")])]):t._e()])})),0)])},I=[],w={props:{settings:{required:!0}},components:{},data:function(){return{settingsData:JSON.parse(this.settings)}},mounted:function(){},computed:{},methods:{isButtonHiddenOnPostType:function(t){return this.settingsData.options&&this.settingsData.options.hide_post_type&&"1"===this.settingsData.options.hide_post_type[t]},isImageSizeHidden:function(t,e){return this.settingsData.options&&this.settingsData.options.hide_size&&this.settingsData.options.hide_size[t]&&"1"===this.settingsData.options.hide_size[t][e]}}},k=w,z=Object(l["a"])(k,S,I,!1,null,null,null),A=z.exports;jQuery(document).ready((function(t){t("body.settings_page_page-cpt").length>0&&(CROP_THUMBNAILS_VUE.app=new D["a"]({el:"#cpt_settings_settingsscreen",mounted:function(){console.log("cpt_settings_settingsscreen mounted")},components:{cptSettingsscreen:A}}))}))},7046:function(t,e,a){},"83a8":function(t,e){(function(){var t={}})()},bc36:function(t,e){jQuery(document).ready((function(t){t(document).on("click",".cropThumbnailsLink",(function(e){e.preventDefault();var a=t(this).data("cropthumbnail"),i=t(this).attr("title"),n=null;void 0!==a.posttype&&(n=a.posttype);var o=new CROP_THUMBNAILS_VUE.modal;o.open(a.image_id,n,i)}))}))}});
//# sourceMappingURL=app.js.map